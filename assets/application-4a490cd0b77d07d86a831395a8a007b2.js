function update_clippings_on_page_count(e){count_span=$("#folder_metadata_bar span.clippings_on_page_count"),current_count=parseInt(count_span.html(),0),count_span.html(current_count-e)}function update_current_folder_page_counts(e){current_folder_slug=$("h2.title").data("folder-slug"),jump_to_folder_inner=$('#jump-to-folder .menu li[data-slug="'+current_folder_slug+'"] .document_count_inner'),add_to_folder_inner=$('#add-to-folder .menu li[data-slug="'+current_folder_slug+'"] .document_count_inner'),jump_to_folder_inner.html(parseInt(jump_to_folder_inner.html(),0)-e),add_to_folder_inner.html(parseInt(add_to_folder_inner.html(),0)-e)}function update_add_folder_count(e,t){add_to_folder_inner=$('#add-to-folder .menu li[data-slug="'+e.folder.slug+'"] .document_count_inner'),void 0===t||"add"===t?add_to_folder_inner.html(parseInt(add_to_folder_inner.html(),0)+e.folder.doc_count):"remove"===t&&add_to_folder_inner.html(parseInt(add_to_folder_inner.html(),0)-e.folder.doc_count)}function update_jump_folder_count(e,t){jump_to_folder_inner=$('#jump-to-folder .menu li[data-slug="'+e.folder.slug+'"] .document_count_inner'),void 0===t||"add"===t?jump_to_folder_inner.html(parseInt(jump_to_folder_inner.html(),0)+e.folder.doc_count):"remove"===t&&jump_to_folder_inner.html(parseInt(jump_to_folder_inner.html(),0)-e.folder.doc_count)}function update_user_util_counts(e,t,n,o){holder=$("#user_utils #document-count-holder"),current_folder_slug=$("h2.title").data("folder-slug"),"my-clippings"===current_folder_slug?(document_count=holder.find("#doc_count"),document_count.html(parseInt(document_count.html(),0)-e),n&&(folder_count=holder.find("#user_folder_count"),folder_count.html(parseInt(folder_count.html(),0)+1)),"delete"!==o&&(documents_in_folders=holder.find("#user_documents_in_folders_count"),documents_in_folders.html(parseInt(documents_in_folders.html(),0)+e))):("my-clippings"===t&&("delete"!==o&&(document_count=holder.find("#doc_count"),document_count.html(parseInt(document_count.html(),0)+e)),documents_in_folders=holder.find("#user_documents_in_folders_count"),documents_in_folders.html(parseInt(documents_in_folders.html(),0)-e)),"delete"===o&&(documents_in_folders=holder.find("#user_documents_in_folders_count"),documents_in_folders.html(parseInt(documents_in_folders.html(),0)-e)))}function add_items_to_folder(e){var t=e.find("a"),n=e.data("slug"),o=t.find(".loader"),i=t.find(".document_count");i.toggle(),o.toggle(),form=$("form#folder_clippings"),form_data=form.serializeArray(),form_data.push({name:"folder_clippings[folder_slug]",value:n}),$.ajax({url:form.prop("action"),data:form_data,type:"POST"}).success(function(e){o.toggle(),inner=i.find(".document_count_inner"),inner.html(parseInt(inner.html(),0)+parseInt(e.folder.doc_count,0)),update_span=$("<span>").addClass("update").html("+"+e.folder.doc_count),t.append(update_span),update_span.animate({opacity:1},1200),setTimeout(function(){update_span.animate({opacity:0},600),i.css("opacity",0).show().animate({opacity:1},1200),_.each(e.folder.documents,function(e){$("#clippings li[data-doc-id='"+e+"']").animate({opacity:0},600)})},1200),setTimeout(function(){_.each(e.folder.documents,function(e){$("#clippings li[data-doc-id='"+e+"']").remove()}),update_clippings_on_page_count(e.folder.doc_count),update_current_folder_page_counts(e.folder.doc_count),update_jump_folder_count(e),update_user_util_counts(e.folder.doc_count,e.folder.slug,!1)},1800)})}function insert_new_folders_into_clipping_menus(e){1===$("#add-to-folder-menu-li-template").length&&(template=Handlebars.compile($("#add-to-folder-menu-li-template").html()),new_folder_li=$(template(e)),new_jump_to_folder_li=new_folder_li.clone(),new_folder_li.css("opacity",0),$("#clipping-actions #add-to-folder .menu ul").append(new_folder_li),new_jump_to_folder_li.find("a").attr("href","/my/folders/"+e.folder.slug),$("#clipping-actions #jump-to-folder .menu ul").append(new_jump_to_folder_li),link=new_folder_li.find("a"),document_count=link.find(".document_count"),document_count.toggle(),update_span=$("<span>").addClass("update").html("+"+e.folder.doc_count).css("opacity",1),link.append(update_span),new_folder_li.animate({opacity:1},1200),setTimeout(function(){update_span.animate({opacity:0},600),document_count.css("opacity",0).show().animate({opacity:1},1200)},1500))}function create_new_folder_with_items(e,t){e.hide(),e.siblings("p").hide(),$("#new-folder-modal .folder_error").hide(),$("new-folder-modal .folder_create").show(),form_data=e.serializeArray(),form_data.push({name:"folder[clipping_ids]",value:t}),$.ajax({url:e.prop("action"),data:form_data,type:"POST"}).success(function(t){$("new-folder-modal .folder_create").hide(),show_folder_success(t),setTimeout(function(){$("#new-folder-modal").jqmHide(),$("#new-folder-modal .folder_success").hide(),e.siblings("p").show(),e.find("input#folder_name").val(""),e.show()},800),setTimeout(function(){insert_new_folders_into_clipping_menus(t)},1025),setTimeout(function(){_.each(t.folder.documents,function(e){$("#clippings li[data-doc-id='"+e+"']").animate({opacity:0},600)})},3725),setTimeout(function(){_.each(t.folder.documents,function(e){$("#clippings li[data-doc-id='"+e+"']").remove()}),update_clippings_on_page_count(t.folder.doc_count),update_current_folder_page_counts(t.folder.doc_count),update_user_util_counts(t.folder.doc_count,t.folder.slug,!0)},4325),setTimeout(function(){$("#clipping-actions").on("mouseleave","#add-to-folder",function(){hide_clipping_menu($(this))}),$("#clipping-actions #add-to-folder").removeClass("hover"),$("#clipping-actions div.menu li#new-folder").removeClass("hover"),hide_clipping_menu($("#clipping-actions #add-to-folder"))},4725)}).fail(function(t){$("new-folder-modal .folder_create").hide(),responseText=$.parseJSON(t.responseText),$("#new-folder-modal .folder_error p .message").html(responseText.errors[0]),$("#new-folder-modal .folder_error").show(),e.siblings("p").show(),e.show()})}function show_clipping_menu(e){e.addClass("hover")}function hide_clipping_menu(e){e.removeClass("hover")}function filter_clippings_by_type(e){var t=e.data("filter-doc-type");e.hasClass("on")?(e.removeClass("on"),e.removeClass("hover"),e.data("tooltip","Show articles of type "+e.data("filter-doc-type-display")),e.tipsy("hide"),e.tipsy("show"),index=_.indexOf(doc_type_filters,t),doc_type_filters[index]=null,doc_type_filters=_.compact(doc_type_filters)):(e.addClass("on"),e.data("tooltip","Hide articles of type "+e.data("filter-doc-type-display")),e.tipsy("hide"),e.tipsy("show"),doc_type_filters.push(t)),documents_to_hide=_.filter($("#clippings li"),function(e){return!_.include(doc_type_filters,$(e).data("doc-type"))}),$("#clippings li").show(),$(documents_to_hide).hide()}function filter_subscriptions_by_type(e){var t=e.data("filter-doc-type");e.hasClass("on")?(e.removeClass("on"),e.removeClass("hover"),e.data("tooltip","Show "+e.data("filter-doc-type-display")+" subscriptions"),e.tipsy("hide"),e.tipsy("show"),index=_.indexOf(subscription_type_filters,t),subscription_type_filters[index]=null,subscription_type_filters=_.compact(subscription_type_filters)):(e.addClass("on"),e.data("tooltip","Hide "+e.data("filter-doc-type-display")+" subscriptions"),e.tipsy("hide"),e.tipsy("show"),subscription_type_filters.push(t)),subscriptions_to_hide=_.filter($("#subscriptions li"),function(e){return!_.include(subscription_type_filters,$(e).data("doc-type"))}),$("#subscriptions li").show(),$(subscriptions_to_hide).hide()}function add_item_to_folder(e,t,n){e.find(".icon.checked").hide(),e.find(".loader").show(),form_data=n.serializeArray(),form_data.push({name:"entry[folder]",value:e.data("slug")}),document_number=n.find("input#entry_document_number").val(),track_clipping_event("add",document_number,e.data("slug")),$.ajax({url:n.prop("action"),data:form_data,type:"POST"}).success(function(n){e.removeClass("not_in_folder").addClass("in_folder"),t.find(".button span.icon").addClass("clipped"),"my-clippings"==e.data("slug")?update_user_clipped_document_count(stored_document_numbers):update_user_folder_document_count(n)}).complete(function(){e.find(".loader").hide(),e.find(".icon.checked").show()})}function insert_new_folder_into_menu(e,t){$("#add-to-folder-menu-li-fr2-template")&&(template=Handlebars.compile($("#add-to-folder-menu-li-fr2-template").html()),e.find(".menu ul").append($(template(t)).css("opacity",0).animate({opacity:1},1500)))}function insert_new_folder_into_other_menu(e,t){$("#add-to-folder-menu-li-fr2-template")&&(template=Handlebars.compile($("#add-to-folder-menu-li-fr2-template").html()),new_li=$(template(t)),e.find(".menu ul").append(new_li),new_li.removeClass("in_folder").addClass("not_in_folder"),new_li.find("a").bind("click",function(e){e.preventDefault()}),new_li.bind("click",function(t){t.preventDefault(),add_item_to_folder($(this),e,e.closest("li").find("form.add_to_clipboard"))}))}function update_user_util_folders(e){update_user_folder_and_document_count(e)}function show_clippings_menu(e){$("#search ol.results")&&e.closest("div.my_fr2").closest("li").css("z-index",1100),e.addClass("hover")}function hide_clippings_menu(e){e.removeClass("hover"),$("#search ol.results")&&e.closest("div.my_fr2").closest("li").css("z-index","auto")}function display_new_folder_modal(e,t){e.unbind("mouseleave"),e.addClass("hover"),e.find(".menu li#new-folder").addClass("hover"),expect_logged_in()?$("#new-folder-modal-template")&&(modal_template=Handlebars.compile($("#new-folder-modal-template").html()),modal=$(modal_template({})),$("#new-folder-modal")&&$("#new-folder-modal").remove(),$("body").append(modal)):$("#account-needed-modal-template")&&(modal_template=Handlebars.compile($("#account-needed-modal-template").html()),modal=$(modal_template({})),$("#account-needed-modal")&&$("#account-needed-modal").remove(),$("body").append(modal)),form=modal.find("form.folder"),form.data("document-number",t),form.data("menu",e),modal.find(".jqmClose").bind("click",function(){e.bind("mouseleave",function(){hide_clippings_menu($(this))}),hide_clippings_menu(e),e.find(".menu li#new-folder").removeClass("hover")}),$(modal).jqm({modal:!0,toTop:!0,onShow:myfr2_jqmHandlers.show,onHide:myfr2_jqmHandlers.hide}),modal.jqmShow().centerScreen()}function create_new_folder(e){menu=e.data("menu"),document_number=e.data("document-number"),e.hide(),e.siblings("p").hide(),$("#new-folder-modal .folder_error").hide(),$("#new-folder-modal .folder_success").hide(),$("#new-folder-modal .folder_create").show(),form_data=e.serializeArray(),form_data.push({name:"folder[document_numbers][]",value:document_number}),$.ajax({url:e.prop("action"),data:form_data,type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))}}).success(function(t){menu.data("active-menu",!0),track_folder_event("create",1),track_clipping_event("add",document_number,e.find("input#folder_name").val()),$("#new-folder-modal .folder_create").hide(),show_folder_success(t),update_user_util_folders(t),setTimeout(function(){$("#new-folder-modal").jqmHide(),$("#new-folder-modal .folder_success").hide(),e.siblings("p").show(),e.find("input#folder_name").val(""),e.show()},1200),setTimeout(function(){insert_new_folder_into_menu(menu,t),menu.find(".button span.icon").addClass("clipped"),0!==$("body#search").length&&$("#clipping-actions.fr2 .add_to_folder").each(function(){other_menu=$(this),other_menu.data("active-menu")!==!0&&insert_new_folder_into_other_menu(other_menu,t)})},1225),setTimeout(function(){menu.bind("mouseleave",function(){hide_clippings_menu($(this))}),hide_clippings_menu(menu),menu.find(".menu li#new-folder").removeClass("hover"),menu.data("active-menu",!1)},3700)}).fail(function(t){$("#new-folder-modal .folder_create").hide(),responseText=$.parseJSON(t.responseText),$("#new-folder-modal .folder_error p .message").html(responseText.errors[0]),$("#new-folder-modal .folder_error").show(),e.siblings("p").show(),e.show()})}function remove_document_from_folder(e,t,n){e.find("a span.icon").hide(),e.find("a span.loader").show(),track_clipping_event("remove",t,e.data("slug")),$.ajax({url:"/my/folder_clippings/delete",data:{folder_clippings:{folder_slug:e.data("slug"),document_number:t}},type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))}}).success(function(t){e.removeClass("in_folder").addClass("not_in_folder"),e.find("a span.loader").hide(),e.find("a span.icon").remove(),checked_span=$("<span>").addClass("checked icon icon-fr2 icon-fr2-badge_check_mark"),e.find("a").append(checked_span),$("body").hasClass("fonts_ie7_lte")&&addIconViaJS(checked_span,"icon-fr2-badge_check_mark"),e.bind("click",function(e){e.preventDefault(),add_item_to_folder($(this),n,n.closest("li").find("form.add_to_clipboard"))}),"my-clippings"!==e.data("slug")?(documents_in_folders=$("#user_utils #document-count-holder #user_documents_in_folders_count"),documents_in_folders.html(parseInt(documents_in_folders.html(),0)-t.folder.doc_count)):(documents_in_clipboard=$("#user_utils #document-count-holder #doc_count"),documents_in_clipboard.html(parseInt(documents_in_clipboard.html(),0)-t.folder.doc_count)),set_clipped_icon_status()})}function add_in_folder_mouseenter_events(e,t,n){e.find("a span.checked.icon").remove();var o=e.find("a");goto_span=$("<span>").addClass("goto icon icon-fr2 icon-fr2-badge_forward_arrow"),o.append(goto_span),delete_span=$("<span>").addClass("delete icon icon-fr2 icon-fr2-badge_x"),o.append(delete_span),$("body").hasClass("fonts_ie7_lte")&&(addIconViaJS(goto_span,"icon-fr2-badge_forward_arrow"),addIconViaJS(delete_span,"icon-fr2-badge_x")),goto_span.bind("click",function(e){e.preventDefault(),e.stopPropagation(),folder=$(this).closest("li").data("slug"),window.location.href="/my/folders/"+folder}),delete_span.bind("click",function(o){o.preventDefault(),o.stopPropagation(),remove_document_from_folder(e,t,n)})}!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n;e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,o){var i=e.Event(n);return t.trigger(i,o),i.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(o){var i,a,r,d,l,s,c,u;if(n.fire(o,"ajax:before")){if(d=o.data("cross-domain"),l=d===t?null:d,s=o.data("with-credentials")||null,c=o.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,o.is("form")){i=o.attr("method"),a=o.attr("action"),r=o.serializeArray();var f=o.data("ujs:submit-button");f&&(r.push(f),o.data("ujs:submit-button",null))}else o.is(n.inputChangeSelector)?(i=o.data("method"),a=o.data("url"),r=o.serialize(),o.data("params")&&(r=r+"&"+o.data("params"))):o.is(n.buttonClickSelector)?(i=o.data("method")||"get",a=o.data("url"),r=o.serialize(),o.data("params")&&(r=r+"&"+o.data("params"))):(i=o.data("method"),a=n.href(o),r=o.data("params")||null);u={type:i||"GET",data:r,dataType:c,beforeSend:function(e,i){return i.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script),n.fire(o,"ajax:beforeSend",[e,i])},success:function(e,t,n){o.trigger("ajax:success",[e,t,n])},complete:function(e,t){o.trigger("ajax:complete",[e,t])},error:function(e,t,n){o.trigger("ajax:error",[e,t,n])},crossDomain:l},s&&(u.xhrFields={withCredentials:s}),a&&(u.url=a);var p=n.ajax(u);return o.trigger("ajax:send",p),p}return!1},handleMethod:function(o){var i=n.href(o),a=o.data("method"),r=o.attr("target"),d=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),s=e('<form method="post" action="'+i+'"></form>'),c='<input name="_method" value="'+a+'" type="hidden" />';l!==t&&d!==t&&(c+='<input name="'+l+'" value="'+d+'" type="hidden" />'),r&&s.attr("target",r),s.hide().append(c).appendTo("body"),s.submit()},disableFormElements:function(t){t.find(n.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(n.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,o=e.data("confirm"),i=!1;return o?(n.fire(e,"confirm")&&(i=n.confirm(o),t=n.fire(e,"confirm:complete",[i])),i&&t):!0},blankInputs:function(t,n,o){var i,a,r=e(),d=n||"input,textarea",l=t.find(d);return l.each(function(){if(i=e(this),a=i.is("input[type=checkbox],input[type=radio]")?i.is(":checked"):i.val(),!a==!o){if(i.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+i.attr("name")+'"]').length)return!0;r=r.add(i)}}),r.length?r:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},n.fire(e(document),"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,o){e.crossDomain||n.CSRFProtection(o)}),e(document).delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),e(document).delegate(n.linkClickSelector,"click.rails",function(o){var i=e(this),a=i.data("method"),r=i.data("params");if(!n.allowAction(i))return n.stopEverything(o);if(i.is(n.linkDisableSelector)&&n.disableElement(i),i.data("remote")!==t){if(!(!o.metaKey&&!o.ctrlKey||a&&"GET"!==a||r))return!0;var d=n.handleRemote(i);return d===!1?n.enableElement(i):d.error(function(){n.enableElement(i)}),!1}return i.data("method")?(n.handleMethod(i),!1):void 0}),e(document).delegate(n.buttonClickSelector,"click.rails",function(t){var o=e(this);return n.allowAction(o)?(n.handleRemote(o),!1):n.stopEverything(t)}),e(document).delegate(n.inputChangeSelector,"change.rails",function(t){var o=e(this);return n.allowAction(o)?(n.handleRemote(o),!1):n.stopEverything(t)}),e(document).delegate(n.formSubmitSelector,"submit.rails",function(o){var i=e(this),a=i.data("remote")!==t,r=n.blankInputs(i,n.requiredInputSelector),d=n.nonBlankInputs(i,n.fileInputSelector);if(!n.allowAction(i))return n.stopEverything(o);if(r&&i.attr("novalidate")==t&&n.fire(i,"ajax:aborted:required",[r]))return n.stopEverything(o);if(a){if(d){setTimeout(function(){n.disableFormElements(i)},13);var l=n.fire(i,"ajax:aborted:file",[d]);return l||setTimeout(function(){n.enableFormElements(i)},13),l}return n.handleRemote(i),!1}setTimeout(function(){n.disableFormElements(i)},13)}),e(document).delegate(n.formInputClickSelector,"click.rails",function(t){var o=e(this);if(!n.allowAction(o))return n.stopEverything(t);var i=o.attr("name"),a=i?{name:i,value:o.val()}:null;o.closest("form").data("ujs:submit-button",a)}),e(document).delegate(n.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),e(document).delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))}),e(function(){var t=e("meta[name=csrf-token]").attr("content"),n=e("meta[name=csrf-param]").attr("content");e('form input[name="'+n+'"]').val(t)}))}(jQuery),window.Modernizr=function(e,t,n){function o(e){_.cssText=e}function i(e,t){return typeof e===t}function a(e,t){return!!~(""+e).indexOf(t)}var r,d,l,s="2.7.1",c={},u=!0,f=t.documentElement,p="modernizr",m=t.createElement(p),_=m.style,h=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),g={svg:"http://www.w3.org/2000/svg"},v={},y=[],b=y.slice,$={}.hasOwnProperty;l=i($,"undefined")||i($.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(e,t){return $.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=b.call(arguments,1),o=function(){if(this instanceof o){var i=function(){};i.prototype=t.prototype;var a=new i,r=t.apply(a,n.concat(b.call(arguments)));return Object(r)===r?r:a}return t.apply(e,n.concat(b.call(arguments)))};return o}),v.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",n="linear-gradient(left top,#9f9, white);";return o((e+"-webkit- ".split(" ").join(t+e)+h.join(n+e)).slice(0,-e.length)),a(_.backgroundImage,"gradient")},v.svg=function(){return!!t.createElementNS&&!!t.createElementNS(g.svg,"svg").createSVGRect};for(var w in v)l(v,w)&&(d=w.toLowerCase(),c[d]=v[w](),y.push((c[d]?"":"no-")+d));return c.addTest=function(e,t){if("object"==typeof e)for(var o in e)l(e,o)&&c.addTest(o,e[o]);else{if(e=e.toLowerCase(),c[e]!==n)return c;t="function"==typeof t?t():t,"undefined"!=typeof u&&u&&(f.className+=" mdrnzr-"+(t?"":"no-")+e),c[e]=t}return c},o(""),m=r=null,c._version=s,c._prefixes=h,f.className=f.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(u?" mdrnzr-js mdrnzr-"+y.join(" mdrnzr-"):""),c}(this,this.document),function(e,t,n){function o(e){return"[object Function]"==h.call(e)}function i(e){return"string"==typeof e}function a(){}function r(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function d(){var e=g.shift();v=1,e?e.t?m(function(){("c"==e.t?f.injectCss:f.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),d()):v=0}function l(e,n,o,i,a,l,s){function c(t){if(!p&&r(u.readyState)&&(y.r=p=1,!v&&d(),u.onload=u.onreadystatechange=null,t)){"img"!=e&&m(function(){$.removeChild(u)},50);for(var o in S[n])S[n].hasOwnProperty(o)&&S[n][o].onload()}}var s=s||f.errorTimeout,u=t.createElement(e),p=0,h=0,y={t:o,s:n,e:a,a:l,x:s};1===S[n]&&(h=1,S[n]=[]),"object"==e?u.data=n:(u.src=n,u.type=e),u.width=u.height="0",u.onerror=u.onload=u.onreadystatechange=function(){c.call(this,h)},g.splice(i,0,y),"img"!=e&&(h||2===S[n]?($.insertBefore(u,b?null:_),m(c,s)):S[n].push(u))}function s(e,t,n,o,a){return v=0,t=t||"j",i(e)?l("c"==t?k:w,e,t,this.i++,n,o,a):(g.splice(this.i++,0,e),1==g.length&&d()),this}function c(){var e=f;return e.loader={load:s,i:0},e}var u,f,p=t.documentElement,m=e.setTimeout,_=t.getElementsByTagName("script")[0],h={}.toString,g=[],v=0,y="MozAppearance"in p.style,b=y&&!!t.createRange().compareNode,$=b?p:_.parentNode,p=e.opera&&"[object Opera]"==h.call(e.opera),p=!!t.attachEvent&&!p,w=y?"object":p?"script":"img",k=p?"script":w,C=Array.isArray||function(e){return"[object Array]"==h.call(e)},j=[],S={},x={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};f=function(e){function t(e){var t,n,o,e=e.split("!"),i=j.length,a=e.pop(),r=e.length,a={url:a,origUrl:a,prefixes:e};for(n=0;r>n;n++)o=e[n].split("="),(t=x[o.shift()])&&(a=t(a,o));for(n=0;i>n;n++)a=j[n](a);return a}function r(e,i,a,r,d){var l=t(e),s=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(i&&(i=o(i)?i:i[e]||i[r]||i[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,i,a,r,d):(S[l.url]?l.noexec=!0:S[l.url]=1,a.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":n,l.noexec,l.attrs,l.timeout),(o(i)||o(s))&&a.load(function(){c(),i&&i(l.origUrl,d,r),s&&s(l.origUrl,d,r),S[l.url]=2})))}function d(e,t){function n(e,n){if(e){if(i(e))n||(u=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}),r(e,u,t,0,s);else if(Object(e)===e)for(l in d=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(),e)e.hasOwnProperty(l)&&(!n&&!--d&&(o(u)?u=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}:u[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(f[l])),r(e[l],u,t,l,s))}else!n&&p()}var d,l,s=!!e.test,c=e.load||e.both,u=e.callback||a,f=u,p=e.complete||a;n(s?e.yep:e.nope,!!c),c&&n(c)}var l,s,u=this.yepnope.loader;if(i(e))r(e,0,u,0);else if(C(e))for(l=0;l<e.length;l++)s=e[l],i(s)?r(s,0,u,0):C(s)?f(s):Object(s)===s&&d(s,u);else Object(e)===e&&d(e,u)},f.addPrefix=function(e,t){x[e]=t},f.addFilter=function(e){j.push(e)},f.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=d,e.yepnope.injectJs=function(e,n,o,i,l,s){var c,u,p=t.createElement("script"),i=i||f.errorTimeout;p.src=e;for(u in o)p.setAttribute(u,o[u]);n=s?d:n||a,p.onreadystatechange=p.onload=function(){!c&&r(p.readyState)&&(c=1,n(),p.onload=p.onreadystatechange=null)},m(function(){c||(c=1,n(1))},i),l?p.onload():_.parentNode.insertBefore(p,_)},e.yepnope.injectCss=function(e,n,o,i,r,l){var s,i=t.createElement("link"),n=l?d:n||a;i.href=e,i.rel="stylesheet",i.type="text/css";for(s in o)i.setAttribute(s,o[s]);r||(_.parentNode.insertBefore(i,_),m(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},/* ========================================================================
 * Bootstrap: dropdown.js v3.0.3
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */
+function(e){"use strict";function t(){e(o).remove(),e(i).each(function(t){var o=n(e(this));o.hasClass("open")&&(o.trigger(t=e.Event("hide.bs.dropdown")),t.isDefaultPrevented()||o.removeClass("open").trigger("hidden.bs.dropdown"))})}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var o=n&&e(n);return o&&o.length?o:t.parent()}var o=".dropdown-backdrop",i="[data-toggle=dropdown]",a=function(t){e(t).on("click.bs.dropdown",this.toggle)};a.prototype.toggle=function(o){var i=e(this);if(!i.is(".disabled, :disabled")){var a=n(i),r=a.hasClass("open");if(t(),!r){if("ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t),a.trigger(o=e.Event("show.bs.dropdown")),o.isDefaultPrevented())return;a.toggleClass("open").trigger("shown.bs.dropdown"),i.focus()}return!1}},a.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var o=e(this);if(t.preventDefault(),t.stopPropagation(),!o.is(".disabled, :disabled")){var a=n(o),r=a.hasClass("open");if(!r||r&&27==t.keyCode)return 27==t.which&&a.find(i).focus(),o.click();var d=e("[role=menu] li:not(.divider):visible a",a);if(d.length){var l=d.index(d.filter(":focus"));38==t.keyCode&&l>0&&l--,40==t.keyCode&&l<d.length-1&&l++,~l||(l=0),d.eq(l).focus()}}}};var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),o=n.data("bs.dropdown");o||n.data("bs.dropdown",o=new a(this)),"string"==typeof t&&o[t].call(n)})},e.fn.dropdown.Constructor=a,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=r,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",i,a.prototype.toggle).on("keydown.bs.dropdown.data-api",i+", [role=menu]",a.prototype.keydown)}(jQuery);var swfobject=function(){function e(){if(!V&&document.getElementsByTagName("body")[0]){try{var e,t=g("span");t.style.display="none",e=R.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(n){return}V=!0;for(var o=z.length,i=0;o>i;i++)z[i]()}}function t(e){V?e():z[z.length]=e}function n(e){if(typeof P.addEventListener!=I)P.addEventListener("load",e,!1);else if(typeof R.addEventListener!=I)R.addEventListener("load",e,!1);else if(typeof P.attachEvent!=I)y(P,"onload",e);else if("function"==typeof P.onload){var t=P.onload;P.onload=function(){t(),e()}}else P.onload=e}function o(){var e=R.getElementsByTagName("body")[0],t=g(A);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",O);var n=e.appendChild(t);if(n){var o=0;!function a(){if(typeof n.GetVariable!=I)try{var r=n.GetVariable("$version");r&&(r=r.split(" ")[1].split(","),G.pv=[v(r[0]),v(r[1]),v(r[2])])}catch(d){G.pv=[8,0,0]}else if(10>o)return o++,setTimeout(a,10),void 0;e.removeChild(t),n=null,i()}()}else i()}function i(){var e=q.length;if(e>0)for(var t=0;e>t;t++){var n=q[t].id,o=q[t].callbackFn,i={success:!1,id:n};if(G.pv[0]>0){var s=h(n);if(s)if(!b(q[t].swfVersion)||G.wk&&G.wk<312)if(q[t].expressInstall&&r()){var c={};c.data=q[t].expressInstall,c.width=s.getAttribute("width")||"0",c.height=s.getAttribute("height")||"0",s.getAttribute("class")&&(c.styleclass=s.getAttribute("class")),s.getAttribute("align")&&(c.align=s.getAttribute("align"));for(var u={},f=s.getElementsByTagName("param"),p=f.length,m=0;p>m;m++)"movie"!=f[m].getAttribute("name").toLowerCase()&&(u[f[m].getAttribute("name")]=f[m].getAttribute("value"));d(c,u,n,o)}else l(s),o&&o(i);else w(n,!0),o&&(i.success=!0,i.ref=a(n),i.id=n,o(i))}else if(w(n,!0),o){var _=a(n);_&&typeof _.SetVariable!=I&&(i.success=!0,i.ref=_,i.id=_.id),o(i)}}}function a(e){var t=null,n=h(e);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(t=typeof n.SetVariable!==I?n:n.getElementsByTagName(A)[0]||n),t}function r(){return!J&&b("6.0.65")&&(G.win||G.mac)&&!(G.wk&&G.wk<312)}function d(e,t,n,o){var i=h(n);if(n=_(n),J=!0,S=o||null,x={success:!1,id:n},i){"OBJECT"==i.nodeName.toUpperCase()?(C=s(i),j=null):(C=i,j=n),e.id=D,(typeof e.width==I||!/%$/.test(e.width)&&v(e.width)<310)&&(e.width="310"),(typeof e.height==I||!/%$/.test(e.height)&&v(e.height)<137)&&(e.height="137"),R.title=R.title.slice(0,47)+" - Flash Player Installation";var a=G.ie?"ActiveX":"PlugIn",r="MMredirectURL="+encodeURIComponent(P.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+a+"&MMdoctitle="+R.title;if(typeof t.flashvars!=I?t.flashvars+="&"+r:t.flashvars=r,G.ie&&4!=i.readyState){var d=g("div");n+="SWFObjectNew",d.setAttribute("id",n),i.parentNode.insertBefore(d,i),i.style.display="none",p(i)}u(e,t,n)}}function l(e){if(G.ie&&4!=e.readyState){e.style.display="none";var t=g("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(s(e),t),p(e)}else e.parentNode.replaceChild(s(e),e)}function s(e){var t=g("div");if(G.win&&G.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(A)[0];if(n){var o=n.childNodes;if(o)for(var i=o.length,a=0;i>a;a++)1==o[a].nodeType&&"PARAM"==o[a].nodeName||8==o[a].nodeType||t.appendChild(o[a].cloneNode(!0))}}return t}function c(e,t){var n=g("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",n.firstChild}function u(e,t,n){var o,i=h(n);if(n=_(n),G.wk&&G.wk<312)return o;if(i){var a,r,d,l=G.ie?g("div"):g(A);typeof e.id==I&&(e.id=n);for(d in t)t.hasOwnProperty(d)&&"movie"!==d.toLowerCase()&&f(l,d,t[d]);G.ie&&(l=c(e.data,l.innerHTML));for(a in e)e.hasOwnProperty(a)&&(r=a.toLowerCase(),"styleclass"===r?l.setAttribute("class",e[a]):"classid"!==r&&"data"!==r&&l.setAttribute(a,e[a]));G.ie?M[M.length]=e.id:(l.setAttribute("type",O),l.setAttribute("data",e.data)),i.parentNode.replaceChild(l,i),o=l}return o}function f(e,t,n){var o=g("param");o.setAttribute("name",t),o.setAttribute("value",n),e.appendChild(o)}function p(e){var t=h(e);t&&"OBJECT"==t.nodeName.toUpperCase()&&(G.ie?(t.style.display="none",function n(){if(4==t.readyState){for(var e in t)"function"==typeof t[e]&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(n,10)}()):t.parentNode.removeChild(t))}function m(e){return e&&e.nodeType&&1===e.nodeType}function _(e){return m(e)?e.id:e}function h(e){if(m(e))return e;var t=null;try{t=R.getElementById(e)}catch(n){}return t}function g(e){return R.createElement(e)}function v(e){return parseInt(e,10)}function y(e,t,n){e.attachEvent(t,n),U[U.length]=[e,t,n]}function b(e){e+="";var t=G.pv,n=e.split(".");return n[0]=v(n[0]),n[1]=v(n[1])||0,n[2]=v(n[2])||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function $(e,t,n,o){var i=R.getElementsByTagName("head")[0];if(i){var a="string"==typeof n?n:"screen";if(o&&(T=null,E=null),!T||E!=a){var r=g("style");r.setAttribute("type","text/css"),r.setAttribute("media",a),T=i.appendChild(r),G.ie&&typeof R.styleSheets!=I&&R.styleSheets.length>0&&(T=R.styleSheets[R.styleSheets.length-1]),E=a}T&&(typeof T.addRule!=I?T.addRule(e,t):typeof R.createTextNode!=I&&T.appendChild(R.createTextNode(e+" {"+t+"}")))}}function w(e,t){if(W){var n=t?"visible":"hidden",o=h(e);V&&o?o.style.visibility=n:"string"==typeof e&&$("#"+e,"visibility:"+n)}}function k(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=I?encodeURIComponent(e):e}var C,j,S,x,T,E,I="undefined",A="object",N="Shockwave Flash",H="ShockwaveFlash.ShockwaveFlash",O="application/x-shockwave-flash",D="SWFObjectExprInst",F="onreadystatechange",P=window,R=document,B=navigator,L=!1,z=[],q=[],M=[],U=[],V=!1,J=!1,W=!0,X=!1,G=function(){var e=typeof R.getElementById!=I&&typeof R.getElementsByTagName!=I&&typeof R.createElement!=I,t=B.userAgent.toLowerCase(),n=B.platform.toLowerCase(),o=n?/win/.test(n):/win/.test(t),i=n?/mac/.test(n):/mac/.test(t),a=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,r="Microsoft Internet Explorer"===B.appName,d=[0,0,0],l=null;if(typeof B.plugins!=I&&typeof B.plugins[N]==A)l=B.plugins[N].description,l&&typeof B.mimeTypes!=I&&B.mimeTypes[O]&&B.mimeTypes[O].enabledPlugin&&(L=!0,r=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),d[0]=v(l.replace(/^(.*)\..*$/,"$1")),d[1]=v(l.replace(/^.*\.(.*)\s.*$/,"$1")),d[2]=/[a-zA-Z]/.test(l)?v(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof P.ActiveXObject!=I)try{var s=new ActiveXObject(H);s&&(l=s.GetVariable("$version"),l&&(r=!0,l=l.split(" ")[1].split(","),d=[v(l[0]),v(l[1]),v(l[2])]))}catch(c){}return{w3:e,pv:d,wk:a,ie:r,win:o,mac:i}}();return function(){G.w3&&((typeof R.readyState!=I&&"complete"==R.readyState||typeof R.readyState==I&&(R.getElementsByTagName("body")[0]||R.body))&&e(),V||(typeof R.addEventListener!=I&&R.addEventListener("DOMContentLoaded",e,!1),G.ie&&(R.attachEvent(F,function t(){"complete"==R.readyState&&(R.detachEvent(F,t),e())}),P==top&&function n(){if(!V){try{R.documentElement.doScroll("left")}catch(t){return setTimeout(n,0),void 0}e()}}()),G.wk&&function o(){return V?void 0:/loaded|complete/.test(R.readyState)?(e(),void 0):(setTimeout(o,0),void 0)}()))}(),z[0]=function(){L?o():i()},function(){G.ie&&window.attachEvent("onunload",function(){for(var e=U.length,t=0;e>t;t++)U[t][0].detachEvent(U[t][1],U[t][2]);for(var n=M.length,o=0;n>o;o++)p(M[o]);for(var i in G)G[i]=null;G=null;for(var a in swfobject)swfobject[a]=null;swfobject=null})}(),{registerObject:function(e,t,n,o){if(G.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=o,q[q.length]=i,w(e,!1)}else o&&o({success:!1,id:e})},getObjectById:function(e){return G.w3?a(e):void 0},embedSWF:function(e,n,o,i,a,l,s,c,f,p){var m=_(n),h={success:!1,id:m};G.w3&&!(G.wk&&G.wk<312)&&e&&n&&o&&i&&a?(w(m,!1),t(function(){o+="",i+="";var t={};if(f&&typeof f===A)for(var _ in f)t[_]=f[_];t.data=e,t.width=o,t.height=i;var g={};if(c&&typeof c===A)for(var v in c)g[v]=c[v];if(s&&typeof s===A)for(var y in s)if(s.hasOwnProperty(y)){var $=X?encodeURIComponent(y):y,k=X?encodeURIComponent(s[y]):s[y];typeof g.flashvars!=I?g.flashvars+="&"+$+"="+k:g.flashvars=$+"="+k}if(b(a)){var C=u(t,g,n);t.id==m&&w(m,!0),h.success=!0,h.ref=C,h.id=C.id}else{if(l&&r())return t.data=l,d(t,g,n,p),void 0;w(m,!0)}p&&p(h)})):p&&p(h)},switchOffAutoHideShow:function(){W=!1},enableUriEncoding:function(e){X=typeof e===I?!0:e},ua:G,getFlashPlayerVersion:function(){return{major:G.pv[0],minor:G.pv[1],release:G.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(e,t,n){return G.w3?u(e,t,n):void 0},showExpressInstall:function(e,t,n,o){G.w3&&r()&&d(e,t,n,o)},removeSWF:function(e){G.w3&&p(e)},createCSS:function(e,t,n,o){G.w3&&$(e,t,n,o)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=R.location.search||R.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return k(t);for(var n=t.split("&"),o=0;o<n.length;o++)if(n[o].substring(0,n[o].indexOf("="))==e)return k(n[o].substring(n[o].indexOf("=")+1))}return""},expressInstallCallback:function(){if(J){var e=h(D);e&&C&&(e.parentNode.replaceChild(C,e),j&&(w(j,!0),G.ie&&(C.style.display="block")),S&&S(x)),J=!1}},version:"2.3"}}();!function(e){var t={width:14,height:14,clippy_path:"clippy.swf",keep_text:!1,force_load:!1,flashvars:{},swfobject_attributes:{}};e.fn.clippy=function(n){n=e.extend(!0,t,n);var o=!1;try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");i&&(o=!0)}catch(a){void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&(o=!0)}o||n.force_load?e.each(e(this),function(t,o){var i="";i="undefined"!=typeof n.text?n.text:e(o).data("text")&&""!=e.trim(e(o).data("text"))?e(o).data("text"):e.trim(e(o).text()),i=encodeURIComponent(i);var a="";if("undefined"==typeof e(o).attr("id")||""===e.trim(e(o).attr("id"))){var r=Math.round(10240*Math.random()).toString(16);a="clippy-"+r,e(o).attr("id",a)}else a=e(o).attr("id");n.keep_text||e(o).html("");var d=e.extend({},n.flashvars,{text:i});swfobject.embedSWF(n.clippy_path,a,n.width,n.height,"10",!1,d,{scale:"noscale"},n.swfobject_attributes)}):e.each(this,function(t,n){e(n).css({display:"none"})})}}(jQuery),$(document).ready(function(){$(".clippy").clippy({keep_text:!0,clippy_path:"/assets/clippy.swf"})}),$(document).ready(function(){$.each($(".toggle"),function(e,t){var n=$(t).parents().first();$(n).on($(t).data("toggle-trigger"),".toggle",function(e){e.preventDefault(),$($(this).data("toggle-target")).toggle()})})}),$(document).ready(function(){$("div#add-to-folder .menu li:not(#new-folder)").live("click",function(e){e.preventDefault(),current_folder_slug=$("h2.title").data("folder-slug"),0!==$("form#folder_clippings input:checked").length&&$(this).data("slug")!==current_folder_slug&&add_items_to_folder($(this))}),$("#add-to-folder .menu li#new-folder").live("click",function(e){if(e.preventDefault(),$("#clipping-actions").off("mouseleave","#add-to-folder"),$("#clipping-actions #add-to-folder").addClass("hover"),$("#clipping-actions div.menu li#new-folder").addClass("hover"),expect_logged_in()?1===$("#new-folder-modal-template").length&&(modal_template=Handlebars.compile($("#new-folder-modal-template").html()),modal=$(modal_template({})),$("#new-folder-modal")&&$("#new-folder-modal").remove(),$("body").append(modal)):1===$("#account-needed-modal-template").length&&(modal_template=Handlebars.compile($("#account-needed-modal-template").html()),modal=$(modal_template({})),$("#account-needed-modal")&&$("#account-needed-modal").remove(),$("body").append(modal)),modal.is("#new-folder-modal")){var t=$("form#folder_clippings .add_to_folder_pane input.clipping_id:checked").length,n="";t>0&&(n="When this folder is created the <strong>"+t+" selected "+(1===t?"clipping":"clippings")+"</strong> will be moved to it."),modal.find("p.instructions span#fyi").html(n)}modal.find(".jqmClose").bind("click",function(){menu=$("#clipping-actions #add-to-folder"),menu.bind("mouseleave",function(){hide_clipping_menu($(this))}),hide_clipping_menu(menu),menu.removeClass("hover"),menu.find(".menu li#new-folder").removeClass("hover")}),$(modal).jqm({modal:!0,toTop:!0,onShow:myfr2_jqmHandlers.show,onHide:myfr2_jqmHandlers.hide}),modal.jqmShow().centerScreen()}),$("#new-folder-modal form.folder").live("submit",function(e){e.preventDefault(),clipping_ids=_.map($("form#folder_clippings .add_to_folder_pane input.clipping_id:checked"),function(e){return $(e).closest("li").data("doc-id")}),create_new_folder_with_items($(this),clipping_ids)})}),$(document).ready(function(){$("ul#clippings li div.clipping_data").each(function(){$(this).height($(this).siblings("div.document_data").height())}),$("ul#clippings li div.add_to_folder_pane").each(function(){$(this).height($(this).closest("ul#clippings li").innerHeight()),input_el=$(this).find("input").last(),input_el.css("margin-top",$(this).height()/2-input_el.height()/2)}),$("#add-to-folder-menu-template").length>0&&(add_to_folder_menu_template=Handlebars.compile($("#add-to-folder-menu-template").html()),$(add_to_folder_menu_template(user_folder_details)).insertAfter("#clipping-actions #doc-type-filter")),$("#jump-to-folder-menu-template").length>0&&(jump_to_folder_menu_template=Handlebars.compile($("#jump-to-folder-menu-template").html()),$(jump_to_folder_menu_template(user_folder_details)).insertAfter("#clipping-actions #doc-type-filter")),$("#clipping-actions").on("mouseenter","#add-to-folder, #jump-to-folder",function(){show_clipping_menu($(this))}),$("#clipping-actions").on("mouseleave","#add-to-folder",function(){hide_clipping_menu($(this))}),$("#clipping-actions").on("mouseleave","#jump-to-folder",function(){hide_clipping_menu($(this))}),$("#clipping-actions").on("click","#remove-clipping",function(){clipping_ids=_.map($("form#folder_clippings input:checked"),function(e){return $(e).closest("li").data("doc-id")}),current_folder_slug=$("h2.title").data("folder-slug"),form=$("form#folder_clippings"),form_data=form.serializeArray(),form_data.push({name:"folder_clippings[clipping_ids]",value:clipping_ids}),form_data.push({name:"folder_clippings[folder_slug]",value:current_folder_slug}),$.ajax({url:"/my/folder_clippings/delete",data:form_data,type:"POST"}).success(function(e){_.each(e.folder.documents,function(e){$("#clippings li[data-doc-id='"+e+"']").animate({opacity:0},600)}),setTimeout(function(){_.each(e.folder.documents,function(e){$("#clippings li[data-doc-id='"+e+"']").remove()}),update_clippings_on_page_count(e.folder.doc_count),update_add_folder_count(e,"remove"),update_jump_folder_count(e,"remove"),update_user_util_counts(e.folder.doc_count,e.folder.slug,!1,"delete")},600)})})}),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},$(document).ready(function(){$("#clipping-actions #doc-type-filter").length>0&&($("#doc-type-filter li").each(function(){_.include(doc_type_filters,$(this).data("filter-doc-type"))?($(this).addClass("on"),$(this).data("tooltip","Hide articles of type "+$(this).data("filter-doc-type-display"))):$(this).addClass("disabled")}),$("#doc-type-filter li:not(.disabled)").bind("mouseenter",function(){$(this).addClass("hover")}),$("#doc-type-filter li:not(.disabled)").bind("mouseleave",function(){$(this).removeClass("hover")}),$("#doc-type-filter li:not(.disabled)").bind("click",function(){filter_clippings_by_type($(this))}))}),$(document).ready(function(){$("#subscription-type-filter li").each(function(){_.include(subscription_type_filters,$(this).data("filter-doc-type"))?($(this).addClass("on"),$(this).data("tooltip","Hide "+$(this).data("filter-doc-type-display")+" subscriptions")):$(this).addClass("disabled")}),$("#subscription-type-filter li:not(.disabled)").bind("mouseenter",function(){$(this).addClass("hover")}),$("#subscription-type-filter li:not(.disabled)").bind("mouseleave",function(){$(this).removeClass("hover")}),$("#subscription-type-filter li:not(.disabled)").bind("click",function(){filter_subscriptions_by_type($(this))})}),$(document).ready(function(){$(".doc_notice.add_tipsy").tipsy({gravity:"e",fallback:"Notice",delayIn:100,fade:!0,offset:0}),$(".doc_rule.add_tipsy").tipsy({gravity:"e",fallback:"Final Rule",delayIn:100,fade:!0,offset:0}),$(".doc_proposed_rule.add_tipsy").tipsy({gravity:"e",fallback:"Proposed Rule",delayIn:100,fade:!0,offset:0}),$(".doc_presidential_document.add_tipsy").tipsy({gravity:"e",fallback:"Presidential Document",delayIn:100,fade:!0,offset:0}),$(".doc_unknown.add_tipsy").tipsy({gravity:"e",fallback:"Document of Unknown Type",delayIn:100,fade:!0,offset:0}),$(".doc_uncategorized.add_tipsy").tipsy({gravity:"e",fallback:"Uncategorized Document",delayIn:100,fade:!0,offset:0}),$(".doc_correct.add_tipsy").tipsy({gravity:"e",fallback:"Correction",delayIn:100,fade:!0,offset:0}),$(".fr-list .rule_type.with-tooltip-e").tipsy({gravity:"e",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$(".fr-list .rule_type.with-tooltip-s").tipsy({gravity:"s",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$(".fr-list .fr-link-stats li.with-tooltip").tipsy({gravity:"e",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$(".fr-table .with-tooltip-s").tipsy({gravity:"s",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$("#clippings li div.add_to_folder_pane").tipsy({gravity:"e",fallback:"Select clipping(s) and modify using menus above",fade:!0,offset:-15}),$("#clipping-actions #add-to-folder").tipsy({gravity:"s",fallback:"Select clipping(s) below to move them",fade:!0,offset:2}),$("#clipping-actions #remove-clipping").tipsy({gravity:"s",fallback:"Delete selected clipping(s)",fade:!0,offset:2}),$("#clipping-actions #doc-type-filter li:not(.disabled)").tipsy({gravity:"s",fade:!1,offset:2,title:function(){return $(this).data("tooltip")}}),$("#doc-type-filter li:not(.disabled)").tipsy({gravity:"s",fade:!0,offset:2,title:function(){return $(this).data("tooltip")}}),$("#subscription-type-filter li:not(.disabled)").tipsy({gravity:"s",fade:!0,offset:2,title:function(){return $(this).data("tooltip")}}),$(".clipping_data .comment_on").tipsy({gravity:"s",fade:!0,offset:3,fallback:"You have officially commented on this article."}),$("#comments .comment_count a.count").tipsy({gravity:"s",delayIn:500,fade:!0,offset:3,title:function(){return $(this).data("tooltip")}})}),$(document).ready(function(){$("form.add_to_clipboard").hide(),$("form.add_to_clipboard").bind("submit",function(e){e.preventeventDefault()}),0!==$(".metadata_share_bar").length&&$(".metadata_share_bar").height($(".metadata_share_bar .metadata").height()).css("overflow","visible"),current_document_number=$("form.add_to_clipboard input#entry_document_number").val(),$("#add-to-folder-menu-fr2-template")&&(add_to_folder_menu_fr2_template=Handlebars.compile($("#add-to-folder-menu-fr2-template").html())),user_folder_details.current_document_number=current_document_number,$("div.share li.clip_for_later").each(function(){var e=current_document_number;0!==$("body#search").length&&(e=$(this).closest("div").closest("li").data("document-number"),user_folder_details.current_document_number=e);var t=$(add_to_folder_menu_fr2_template(user_folder_details));$(this).append($("<div>").addClass("fr2").prop("id","clipping-actions").append(t)),t.bind("mouseenter",function(){show_clippings_menu($(this))}),t.bind("mouseleave",function(){hide_clippings_menu($(this))}),t.on("click",".button .icon",function(){not_in_clipboard=0!==$(t).find('.menu li[data-slug="my-clippings"].not_in_folder').length,not_in_clipboard&&$(t).find('.menu li[data-slug="my-clippings"]').trigger("click")}),t.find(".menu li, .menu li a").bind("click",function(e){e.preventDefault()}),t.find(".menu li.not_in_folder").bind("click",function(e){e.preventDefault(),add_item_to_folder($(this),t,t.closest("li").find("form.add_to_clipboard"))}),0!==$("body#search").length&&void 0!==user_folder_details&&document_number_present(e,user_folder_details)&&t.find(".button span.icon").addClass("clipped"),t.find(".menu li#new-folder").bind("click",function(n){n.preventDefault(),display_new_folder_modal(t,e)}),t.on("mouseenter",".menu li.in_folder",function(){$li=$(this),$li.addClass("hover"),add_in_folder_mouseenter_events($li,e,t)}),t.on("mouseleave",".menu li.in_folder",function(){var e=$(this);e.find("a span.delete.icon").remove(),e.find("a span.goto.icon").remove(),e.removeClass("hover"),0===e.find("a span.checked.icon").length&&(checked_span=$("<span>").addClass("checked icon icon-fr2 icon-fr2-badge_check_mark"),e.find("a").append(checked_span),$("body").hasClass("fonts_ie7_lte")&&addIconViaJS(checked_span,"icon-fr2-badge_check_mark"))})}),0===$("body#search").length&&void 0!==user_folder_details&&document_number_present(current_document_number,user_folder_details)&&$("div.share li.clip_for_later #add-to-folder .button span.icon").addClass("clipped"),$("#new-folder-modal form.folder").live("submit",function(e){e.preventDefault(),create_new_folder($(this))}),$(".add_to_folder .button.tip_over").tipsy({gravity:"south",offset:3,live:!0})}),$(document).ready(function(){if($(".doc-official .doc-content").length>0){var e=$(".doc-official .doc-content").outerHeight(),t=$(".doc-aside.doc-details").outerHeight(),n=50,o=30;t+n>e&&$(".doc-content .fr-box.fr-box-official").css("height",t+n+o)}}),$(document).ready(function(){if($(".doc-public-inspection .doc-content").length>0){var e=$(".doc-public-inspection .doc-content").outerHeight(),t=$(".doc-aside.doc-details").outerHeight(),n=50,o=30;t+n>e&&$(".doc-content .fr-box.fr-box-public-inspection").css("height",t+n+o)}});var FollowElement=function(){var e=function(){this.default_options={top_offset:0,bottom_offset:0,throttle_value:500,debug:!1},this.animating=!1};return e.prototype={init:function(e,t,n){this.$el=e,this.$el_wrapper=t,this.$window=$(window),this.previous_scroll=$(window).scrollTop(),this.original_offset=e.offset().top,this.options="object"==typeof n?$.extend(this.default_options,n):this.default_options,this.update_on_scroll()},update_on_scroll:function(){var e=this;_.throttle(e.$window.on("scroll",function(){var t=e.scroll_direction(e.previous_scroll),n="";if("up"===t&&e.$window.scrollTop()<=e.original_offset&&!e.$el.hasClass("fixed"))return n="no follow",void 0;if("down"===t)e.el_top_out_of_viewport(e.$el_wrapper)&&(e.$el.addClass("fixed"),e.$el.css("top",e.options.top_offset),n="out of top",e.bottom_offset(e.$el)>=e.bottom_offset(e.$el_wrapper)&&(e.$el.removeClass("fixed"),e.$el.css("top",e.bottom_offset(e.$el_wrapper)-e.$el.outerHeight()-e.original_offset-e.options.bottom_offset),n="at bottom"));else if("up"===t&&e.el_bottom_out_of_viewport(e.$el_wrapper)){if(!e.$el.hasClass("fixed")&&!e.animating){e.animating=!0;var o=e.$el.position().top+e.options.top_offset-200;e.$el.animate({top:o},100,function(){e.animating=!1,e.$el.addClass("fixed"),e.$el.css("top",e.options.top_offset)})}n="out of bottom",e.$el.offset().top<=e.original_offset&&(e.$el.removeClass("fixed"),e.$el.css("top","inherit"),n="at top")}e.previous_scroll=e.$window.scrollTop(),e.options.debug&&console.log(t,n)}),this.options.throttle_value)},bottom_offset:function(e){var t=this,n=e.offset().top+e.outerHeight();return e==t.$el&&(n+=t.options.bottom_offset),n},scroll_direction:function(e){var t=$(window).scrollTop();return t>e?"down":"up"},el_top_out_of_viewport:function(e){var t=this,n=t.$window.scrollTop(),o=e.offset().top;return n>=o},el_bottom_in_viewport:function(e){var t=this,n=t.$window.scrollTop(),o=n+t.$window.height();return o>=t.bottom_offset(e)},el_bottom_out_of_viewport:function(e){var t=this,n=t.$window.scrollTop(),o=n+t.$window.height();return o<=t.bottom_offset(e)}},e}();$(document).ready(function(){if($("ul.doc-nav li").hover(function(){$(this).find(".dropdown-menu").stop(!0,!0).show(),$(this).addClass("open")},function(){$(this).find(".dropdown-menu").stop(!0,!0).hide(),$(this).removeClass("open")}),$(".doc-official .doc-nav").length>0){var e=new FollowElement;e.init($(".doc-nav"),$(".doc-nav-wrapper"),{top_offset:15,bottom_offset:225,debug:!1})}$(".doc-nav-wrapper").length>0&&$(".doc-nav-wrapper").outerHeight($(".doc-nav-wrapper").siblings(".fr-box").first().height()+"px")}),$(document).ready(function(){var e=$(".nav-home-carousel .nav li"),t=$(".nav-home-carousel .nav-content");$(".nav-home-carousel .nav").on("click","li",function(n){n.preventDefault(),_.each(e,function(e){$(e).removeClass("selected")}),$(this).addClass("selected"),_.each(t,function(e){$(e).hide()}),$($(this).data("toggle-target")).show()})});